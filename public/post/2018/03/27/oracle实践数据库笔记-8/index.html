<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Oracle实践数据库笔记-8 - 了解Oracle对控制文件ctl的管理和对日志文件rog的管理和操作  - Rehoni.</title>
    <meta property="og:title" content="Oracle实践数据库笔记-8 - Rehoni.">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="oradebug dump controlf 3 oradebug setmypid oradebug tracefile_name
alter session set nls_language=american
[&amp;hellip;] 控制文件的复用🆗 内容一模一样，做多个同样的控制文件放在不同的地方
见ppt 126/383 alter system set control_files = &amp;hellip;">
      <meta property="og:description" content="oradebug dump controlf 3 oradebug setmypid oradebug tracefile_name
alter session set nls_language=american
[&amp;hellip;] 控制文件的复用🆗 内容一模一样，做多个同样的控制文件放在不同的地方
见ppt 126/383 alter system set control_files = &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">Rehoni.</a></h1>

<p class="tagline">你有双牧羊人的眼睛，在你眼里谁是羊群，毫无头绪</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/categories/">Categories</a></li>
  
  <li><a href="/tags/">Tags</a></li>
  
  <li><a href="/index.xml">Subscribe</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Oracle实践数据库笔记-8</h1>
<h1><span class="subtitle">了解Oracle对控制文件ctl的管理和对日志文件rog的管理和操作</span></h1>
<h3>
  2018-03-27</h3>
<hr>


      </header>





<h1 id="3-27-实例数据库"><sup>3</sup>&frasl;<sub>27</sub> 实例数据库</h1>

<h2 id="管理控制文件">管理控制文件</h2>

<ol>
<li>控制文件的作用❓</li>
<li>控制文件的内容❓二进制</li>
</ol>

<p>oradebug dump controlf 3
oradebug setmypid
oradebug tracefile_name</p>

<p>alter session set nls_language=american</p>

<ol>
<li><p>控制文件的复用🆗
内容一模一样，做多个同样的控制文件放在不同的地方</p>

<pre><code class="language-sql">见ppt 126/383
alter system set control_files = 'path1','path2','path3' scope=spfile;
shutdown
cp 'path1'/'path2' 'path3';
startup
show parameter control_files;
</code></pre></li>

<li><p>创建控制文件</p>

<pre><code class="language-sql">alter database backup controlfile to trace as 'e:\trace_controlf.txt'
alter database mount
删除控制文件之后启动报错再启动一下脚本
语句在trace_controlf.txt里边跑一下
</code></pre></li>
</ol>

<p>实验：</p>

<ol>
<li>查看控制文件的名称和内容🆗
select name &hellip;
show parameter control_files;
oradebug &hellip;见上</li>
<li>控制文件的复用🆗</li>
<li>创建控制文件</li>
</ol>

<p><strong>不是很清楚，再看大佬演示一下跑一下脚本</strong></p>

<h2 id="管理日志文件">管理日志文件</h2>

<ol>
<li>日志文件的作用</li>
<li>日志工作体系</li>

<li><p>日志管理</p>

<p><strong>务必搞清楚一下switch和checkpoint两条命令</strong> 😋</p>

<ul>
<li>查询日志文件组，日志文件成员，归档日志🆗
desc一下就知道了v$log v$logfile v$archived_log</li>

<li><p>添加日志文件组🆗</p>

<pre><code class="language-sql">alter database add logfile group 4;
</code></pre></li>

<li><p>向日志文件组添加成员🆗</p>

<pre><code class="language-sql">alter database add logfile member 'path' to group 4;
</code></pre></li>

<li><p>删除日志文件成员🆗</p>

<pre><code class="language-sql">alter database drop logfile member 'path' to group 4;
select group#，status from v$log;
</code></pre></li>

<li><p>删除日志文件组🆗
日志组删除时日志文件还在不在：
如果是OMF日志文件则不在，默认情况下是在的</p>

<pre><code class="language-sql">alter database drop logfile group 4;
</code></pre></li>

<li><p>清除日志文件🆗</p>

<pre><code class="language-sql">alter database clear logfile 'path';
</code></pre></li>

<li><p>OMF 没听
创建一个路径放入日志文件，OMF形式</p></li>

<li><p>设置归档模式</p>

<pre><code class="language-sql">---要在 mount模式下
startup mount
alter database archivelog;
archive log list;
alter database noarchivelog;
</code></pre></li>

<li><p>设置归档目的地</p></li>

<li><p>手动归档</p>

<pre><code class="language-sql">show parameter log_archive
alter system set log_archive_dest_1='location=path1'
alter system archieve log current
</code></pre></li>

<li><p>移动或者重命名日志文件</p>

<pre><code class="language-sql">select group#, from v$logfile
shutdown immediate之后剪切（从原路径）一个log文件到别的目录（现在路径）
startup mount不报错，不检测日志文件
alter database open报错，看报错信息，找E:\app\Res0liya\diag\rdbms\orcl\orcl\trace目录下的alert_orcl.log看报错信息，从后到前
select menber from v$logfile
alter database rename file '原路径' to '现在路径'
alter database open就不报错了
</code></pre></li>

<li><p>修复日志文件</p>

<ul>
<li><p>非当前的文件出问题</p>

<pre><code class="language-sql">select group#,status from v$log;
alter database clear logfile group 1;
alter database open
</code></pre></li>

<li><p>当前的文件出问题</p>

<pre><code class="language-sql">recover database until cancel;
alter database open;报错
alter database open resetlogs;重新创建新日志文件
</code></pre></li>
</ul></li>
</ul></li>
</ol>

<h2 id="其他代码">其他代码</h2>

<pre><code class="language-sql">    ORA-24324: 未初始化服务句柄
    ORA-01041: 内部错误, hostdef 扩展名不存在
    出现shutdown问题采用
    shutdown abort
</code></pre>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/post/2018/03/23/oracle%E5%AE%9E%E8%B7%B5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0-7/">Oracle实践数据库笔记-7</a></span>
  <span class="nav-next"><a href="/post/2018/03/30/oracle%E5%AE%9E%E8%B7%B5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0-9/">Oracle实践数据库笔记-9</a> &rarr;</span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="https://github.com/rehoni">Rehoni</a> 2019 | <a href="resliya@outlook.com">Email</a> | <a href="https://www.zhihu.com/people/luo-hao-37-27/activities">ZhiHu</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

