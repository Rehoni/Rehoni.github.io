<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Oracleå®è·µæ•°æ®åº“ç¬”è®°-12 - Oracleæ•°æ®åº“çš„å¤‡ä»½å’Œæ¢å¤  - Rehoni.</title>
    <meta property="og:title" content="Oracleå®è·µæ•°æ®åº“ç¬”è®°-12 - Rehoni.">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="logmnrçš„ä½¿ç”¨
[&amp;hellip;] å¯åŠ¨æ•°æ®åº“è¡¥å……æ—¥å¿—
desc v$database ğŸ†— select supplementallog from v$database ---ä¸å¤ªç¡®å®šsupplementallog alter database add supplemental log data;ğŸ†—  äº§ç”Ÿæ•°æ®å­—å…¸æ–‡ä»¶
[&amp;hellip;] è®¾ç½®æ•°æ®å­—å…¸æ–‡ä»¶çš„ç›®çš„åœ°(åˆå§‹åŒ–å‚æ•°) &amp;hellip;">
      <meta property="og:description" content="logmnrçš„ä½¿ç”¨
[&amp;hellip;] å¯åŠ¨æ•°æ®åº“è¡¥å……æ—¥å¿—
desc v$database ğŸ†— select supplementallog from v$database ---ä¸å¤ªç¡®å®šsupplementallog alter database add supplemental log data;ğŸ†—  äº§ç”Ÿæ•°æ®å­—å…¸æ–‡ä»¶
[&amp;hellip;] è®¾ç½®æ•°æ®å­—å…¸æ–‡ä»¶çš„ç›®çš„åœ°(åˆå§‹åŒ–å‚æ•°) &amp;hellip;">
      
    

    
    
    <meta name="twitter:image" content="https://static.notion-static.com/3729c29a-5919-4e8e-8496-e24177713690/Untitled">
    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">Rehoni.</a></h1>

<p class="tagline">ä½ æœ‰åŒç‰§ç¾Šäººçš„çœ¼ç›ï¼Œåœ¨ä½ çœ¼é‡Œè°æ˜¯ç¾Šç¾¤ï¼Œæ¯«æ— å¤´ç»ª</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">âœ•</span>
    <span class="icon open-icon">â˜°</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/categories/">Categories</a></li>
  
  <li><a href="/tags/">Tags</a></li>
  
  <li><a href="/index.xml">Subscribe</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Oracleå®è·µæ•°æ®åº“ç¬”è®°-12</h1>
<h1><span class="subtitle">Oracleæ•°æ®åº“çš„å¤‡ä»½å’Œæ¢å¤</span></h1>
<h3>
  2018-04-08</h3>
<hr>


      </header>





<h1 id="oracleå®è·µæ•°æ®åº“">Oracleå®è·µæ•°æ®åº“</h1>

<h2 id="æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤">æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤</h2>

<ul>
<li><strong>éœ€è¦æ•°æ®åº“å¤‡ä»½æ¢å¤çš„æƒ…å†µ</strong> PDF D17090</li>

<li><p><strong>logmnrçš„ä½¿ç”¨</strong></p>

<ul>
<li><p><strong>å¯åŠ¨æ•°æ®åº“è¡¥å……æ—¥å¿—</strong></p>

<pre><code class="language-sql">desc v$database ğŸ†—
select supplementallog from v$database ---ä¸å¤ªç¡®å®šsupplementallog 
alter database add supplemental log data;ğŸ†—
</code></pre></li>

<li><p><strong>äº§ç”Ÿæ•°æ®å­—å…¸æ–‡ä»¶</strong></p></li>

<li><p><strong>è®¾ç½®æ•°æ®å­—å…¸æ–‡ä»¶çš„ç›®çš„åœ°(åˆå§‹åŒ–å‚æ•°)</strong></p></li>

<li><p><strong>äº§ç”Ÿæ•°æ®å­—å…¸æ–‡ä»¶</strong></p></li>

<li><p><strong>äº§ç”Ÿä¸€ä¸ªäº‹åŠ¡</strong></p></li>

<li><p><strong>æ·»åŠ éœ€è¦åˆ†æçš„æ—¥å¿—æ–‡ä»¶</strong></p></li>

<li><p><strong>å¯åŠ¨åˆ†æ</strong></p></li>

<li><p><strong>æŸ¥è¯¢å†…å®¹</strong></p>

<pre><code class="language-sql">---è€å¸ˆæ•™ç¨‹ 
---è‡ªå·±è·‘ä¸€éğŸ†—
---è®¾ç½®ä¸€ä¸‹ç›®å½•,å¾—å…ˆåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºå¥½æ–‡ä»¶å¤¹
show parameter utl_file_dir  ğŸ†—
---é‡å¯ç”Ÿæ•ˆshutdown immediate&amp;startup , path1ä¸ºä¹‹å‰åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºå¥½çš„æ–‡ä»¶å¤¹è·¯å¾„ ğŸ†—
alter system set utl_file_dir ='path1' scope=spfile;ğŸ†— ---å†showä¸€éæ˜¯æ²¡æœ‰çš„,é‡å¯æ‰ç”Ÿæ•ˆ 
execute dbms_logmnr_d.build(dictionary_filename=&gt;'åå­—.ora',dictionary_location=&gt;'path')ğŸ†—
---äº§ç”Ÿæ•°æ®æ–‡ä»¶ æäº¤äº‹åŠ¡
select empno,ename,sal from emp;ğŸ†—
update emp set sal=5000 where empno=7934;ğŸ†—
commit;ğŸ†—
execute dbms_logmnr.add_logfile(LogFileName=&gt;'path2',Options=&gt;dbms_logmnr.new)ğŸ†—
---å¦‚æœæ˜¯è¿½åŠ ä¸º.addfile
select group\#,status from v$log;ğŸ†— ---æŸ¥è¯¢å½“å‰ç»„ current
select group\#,member from v$logfile;ğŸ†—
---å¯¹åº”currentç¼–å·çš„path2=&gt;E:\APP\RES0LIYA\ORADATA\ORCL\REDO02.LOG
execute dbms_logmnr.start_logmnr(DictFileName=&gt;'path1')ğŸ†— ---æ•°æ®å­—å…¸æ–‡ä»¶åœ¨æ­¤æ­¥ä¹‹å‰åˆ›å»ºå¥½å°±è¡Œ
---æŠ¥é”™,sysauxæŠ¥é”™ â—å› ä¸ºæœ¬èº«æ²¡æœ‰è„±æœºæ‰€ä»¥æ²¡æœ‰ç¢°åˆ°è¿™ä¸ªbug
desc dbs_tablespaces
select tablespacename,status from dbs_tablespaces
---å‘ç°sysauxè„±æœºäº†,è®©å®ƒè”æœºå°±ok
desc v$logmnr_contentsğŸ†—
select TIMESTAMP,USERNAME,SQL_REDO from v$logmnr_contentsğŸ†—---ä¸€å®šè¦è®°å¾—é€‰åŠ where
where SEG_NAME='EMP' and OPERATION='UPDATE'ğŸ†—
---è°ƒæ•´æ—¶é—´æ ¼å¼ alter set session nls_date_format=''
</code></pre>

<p><img src="https://static.notion-static.com/3729c29a-5919-4e8e-8496-e24177713690/Untitled" alt="æ•ˆæœå›¾" /></p></li>
</ul></li>

<li><p><strong>å¤‡ä»½ç±»å‹</strong></p>

<ul>
<li><strong>ç”¨æˆ·ç®¡ç†çš„å¤‡ä»½</strong></li>

<li><p><strong>å†·å¤‡ä»½â€”å…³é—­æ•°æ®åº“çš„å¤‡ä»½/ä¸€è‡´æ€§å¤‡ä»½</strong></p>

<ul>
<li><strong>æ–‡ä»¶åˆ—è¡¨</strong></li>

<li><p><strong>shutdown</strong></p>

<pre><code class="language-sql">spool E:\app\luohaobackup\filelist.txt
show parameter spfile
select name from v$controlfile;
select member from v$logfile;
select name from v$datafile;
select name from v$tempfile;
---æ£€æµ‹ä¸€ä¸‹æ˜¯å¦ä¸ºå­˜æ¡£æ¨¡å¼
archive log list ---å¦‚æœæ˜¯å­˜æ¡£æ¨¡å¼
---å¼€å¯å½’æ¡£æ¨¡å¼
shutdown immediate
startup mount ---æ­£å¸¸startup ä¸ºopençŠ¶æ€æ•°æ®åº“æ‰“å¼€,mountä¸ºè£…è½½æ•°æ®åº“,nomountä¸ºå®ä¾‹å¯åŠ¨
---
select name from v$archivelog
spool off
create table scott.cold(a varchar(20));
insert into scott.cold values('before backup');
select * from scott.cold;
commit;
shutdown immediate
---åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­å¤åˆ¶ç²˜è´´æ‰€æœ‰æ–‡ä»¶,è·¯å¾„å¯ä»¥åœ¨ä¸Šè¾¹æŸ¥åˆ°
---.SPFILEæ–‡ä»¶,å¤–éƒ¨,æ²¡æœ‰shutdownä¸å½±å“
---.CTLæ§åˆ¶æ–‡ä»¶,éƒ½æ˜¯ä¸€æ ·
---.LOGæ—¥å¿—æ–‡ä»¶
---.DBFæ•°æ®æ–‡ä»¶
---.ARCå½’æ¡£æ–‡ä»¶
startup
insert into scott.cold value('after backup');
select * from scott.cold;
shutdown immediate
---æ–°å»ºä¸€ä¸ªlogæ–‡ä»¶å¤¹ æ”¾å…¥.CTLå’Œ.LOGæ–‡ä»¶
startup
cmd&gt;dbca ---åˆ é™¤æ•°æ®åº“orcl
---æ¢å¤ â—
cmd&gt;oradim -new -sid sales;
---æŠŠSPFILEæ”¾å…¥E:\app\Res0liya\product\11.2.0\dbhome_1\database
---æ ¹æ®SPFILEçš„å†…å®¹åˆ›å»ºå„ç§ç›®å½•
select * from v$recoverfile
recover database
alter database open
select * from scott.cold
        
---æˆ‘çš„æ“ä½œ
cortana&gt; net configuration assistant ---é…ç½®ç›‘å¬å™¨
admin cmd&gt; dbca 
---å‚»ç“œå¼åˆ›å»ºå®Œåº“luohaoä¹‹å
---net start æœåŠ¡å å¯åŠ¨æœåŠ¡å
cmd&gt; set oracle_sid=luohao
cmd&gt; sqlplus ---è¾“å…¥sys as sysdba å¯†ç 
sql&gt; show parameter db_name;---luohao
conn scott ---æœªè§£é” è§£é”
alter user scott account unlock;
alter user scott identified by tiger;
conn scott/tiger
</code></pre></li>
</ul></li>

<li><p><strong>çƒ­å¤‡ä»½ å¯ä»¥åšå…¨å¤‡ä»½ä¹Ÿå¯ä»¥åšéƒ¨åˆ†å¤‡ä»½</strong></p>

<ul>
<li><strong>å½’æ¡£æ¨¡å¼</strong></li>

<li><p><strong>å¤‡ä»½æ¨¡å¼</strong></p>

<pre><code class="language-sql">select tablespace_name from dba_tables
where table_name='COLD';
select file_name from dba_data_files
where tablespace_name='USERS';---åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æ‹·è´ä¸€ä»½
select * from v$backup;
---å•ä¸ªè¡¨
alter tablespace users begin backup;---å¼€å¯å¤‡ä»½æ¨¡å¼
select * from scott.cold;
insert into scott.cold values('after hot backup');
commit;
alter tablespace users offline;
ç¬¬ 1 è¡Œå‡ºç°é”™è¯¯:
ORA-01150: æ— æ³•é˜²æ­¢å†™å…¥ - æ–‡ä»¶ 4 è®¾ç½®äº†è”æœºå¤‡ä»½
ORA-01110: æ•°æ®æ–‡ä»¶ 4: 'E:\APP\RES0LIYA\ORADATA\LUOHAO\USERS01.DBF'
alter tablespace users end backup;---ç»“æŸå¤‡ä»½æ¨¡å¼
alter tablespace users offline;---åˆ é™¤users01.dbf,æ‹·è´åŸæ¥çš„å›å»
alter tablespace users online;
ORA-01113: æ–‡ä»¶ 4 éœ€è¦ä»‹è´¨æ¢å¤
ORA-01110: æ•°æ®æ–‡ä»¶ 4: 'E:\APP\RES0LIYA\ORADATA\LUOHAO\USERS01.DBF'
recover datafile 4;æˆ–è€…alter tablespace users ...
alter tablespace users online;
select * from scott.cold;
---å¤šä¸ªè¡¨
alter database begin backup
</code></pre>

<p><img src="https://static.notion-static.com/4be09484-4e67-4108-8c42-71145a288546/Untitled" alt="æ•ˆæœå›¾" /></p></li>
</ul></li>

<li><p><strong>æœåŠ¡å™¨ç®¡ç†çš„å¤‡ä»½ (RMAN)</strong></p></li>
</ul></li>
</ul>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/post/2018/04/08/oracle%E5%AE%9E%E8%B7%B5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0-13/">Oracleå®è·µæ•°æ®åº“ç¬”è®°-13</a></span>
  <span class="nav-next"><a href="/post/2018/04/08/oracle%E5%AE%9E%E8%B7%B5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0-11/">Oracleå®è·µæ•°æ®åº“ç¬”è®°-11</a> &rarr;</span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="https://github.com/rehoni">Rehoni</a> 2019 | <a href="resliya@outlook.com">Email</a> | <a href="https://www.zhihu.com/people/luo-hao-37-27/activities">ZhiHu</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

